/*!
 * in-view 0.6.1 - Get notified when a DOM element enters or exits the viewport.
 * Copyright (c) 2016 Cam Wiegert <cam@camwiegert.com> - https://camwiegert.github.io/in-view
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.inView=e():t.inView=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var i=n(2),o=r(i);t.exports=o["default"]},function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=r(i),u=n(3),f=r(u),s=n(4),c=function(){if("undefined"!=typeof window){var t=100,e=["scroll","resize","load"],n={history:[]},r={offset:{},threshold:0,test:s.inViewport},i=(0,o["default"])(function(){n.history.forEach(function(t){n[t].check()})},t);e.forEach(function(t){return addEventListener(t,i)}),window.MutationObserver&&addEventListener("DOMContentLoaded",function(){new MutationObserver(i).observe(document.body,{attributes:!0,childList:!0,subtree:!0})});var u=function(t){if("string"==typeof t){var e=[].slice.call(document.querySelectorAll(t));return n.history.indexOf(t)>-1?n[t].elements=e:(n[t]=(0,f["default"])(e,r),n.history.push(t)),n[t]}};return u.offset=function(t){if(void 0===t)return r.offset;var e=function(t){return"number"==typeof t};return["top","right","bottom","left"].forEach(e(t)?function(e){return r.offset[e]=t}:function(n){return e(t[n])?r.offset[n]=t[n]:null}),r.offset},u.threshold=function(t){return"number"==typeof t&&t>=0&&t<=1?r.threshold=t:r.threshold},u.test=function(t){return"function"==typeof t?r.test=t:r.test},u.is=function(t){return r.test(t,r)},u.offset(0),u}};e["default"]=c()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r){n(this,t),this.options=r,this.elements=e,this.current=[],this.handlers={enter:[],exit:[]},this.singles={enter:[],exit:[]}}return r(t,[{key:"check",value:function(){var t=this;return this.elements.forEach(function(e){var n=t.options.test(e,t.options),r=t.current.indexOf(e),i=r>-1,o=n&&!i,u=!n&&i;o&&(t.current.push(e),t.emit("enter",e)),u&&(t.current.splice(r,1),t.emit("exit",e))}),this}},{key:"on",value:function(t,e){return this.handlers[t].push(e),this}},{key:"once",value:function(t,e){return this.singles[t].unshift(e),this}},{key:"emit",value:function(t,e){for(;this.singles[t].length;)this.singles[t].pop()(e);for(var n=this.handlers[t].length;--n>-1;)this.handlers[t][n](e);return this}}]),t}();e["default"]=function(t,e){return new i(t,e)}},function(t,e){"use strict";function n(t,e){var n=t.getBoundingClientRect(),r=n.top,i=n.right,o=n.bottom,u=n.left,f=n.width,s=n.height,c={t:o,r:window.innerWidth-u,b:window.innerHeight-r,l:i},a={x:e.threshold*f,y:e.threshold*s};return c.t>e.offset.top+a.y&&c.r>e.offset.right+a.x&&c.b>e.offset.bottom+a.y&&c.l>e.offset.left+a.x}Object.defineProperty(e,"__esModule",{value:!0}),e.inViewport=n},function(t,e){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,function(){return this}())},function(t,e,n){var r=n(5),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){function r(t,e,n){function r(e){var n=x,r=m;return x=m=void 0,E=e,w=t.apply(r,n)}function a(t){return E=t,j=setTimeout(h,e),M?r(t):w}function l(t){var n=t-O,r=t-E,i=e-n;return _?c(i,g-r):i}function d(t){var n=t-O,r=t-E;return void 0===O||n>=e||n<0||_&&r>=g}function h(){var t=o();return d(t)?p(t):void(j=setTimeout(h,l(t)))}function p(t){return j=void 0,T&&x?r(t):(x=m=void 0,w)}function v(){void 0!==j&&clearTimeout(j),E=0,x=O=m=j=void 0}function y(){return void 0===j?w:p(o())}function b(){var t=o(),n=d(t);if(x=arguments,m=this,O=t,n){if(void 0===j)return a(O);if(_)return j=setTimeout(h,e),r(O)}return void 0===j&&(j=setTimeout(h,e)),w}var x,m,g,w,j,O,E=0,M=!1,_=!1,T=!0;if("function"!=typeof t)throw new TypeError(f);return e=u(e)||0,i(n)&&(M=!!n.leading,_="maxWait"in n,g=_?s(u(n.maxWait)||0,e):g,T="trailing"in n?!!n.trailing:T),b.cancel=v,b.flush=y,b}var i=n(1),o=n(8),u=n(10),f="Expected a function",s=Math.max,c=Math.min;t.exports=r},function(t,e,n){var r=n(6),i=function(){return r.Date.now()};t.exports=i},function(t,e,n){function r(t,e,n){var r=!0,f=!0;if("function"!=typeof t)throw new TypeError(u);return o(n)&&(r="leading"in n?!!n.leading:r,f="trailing"in n?!!n.trailing:f),i(t,e,{leading:r,maxWait:e,trailing:f})}var i=n(7),o=n(1),u="Expected a function";t.exports=r},function(t,e){function n(t){return t}t.exports=n}])});

/*!
 * Tiny Date Picker
 * Copyright (c) 2015 Chris Davies
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.TinyDatePicker=e()}(this,function(){"use strict";function l(){var t=new Date;return t.setHours(0,0,0,0),t}function f(t,e){return(t&&t.toDateString())===(e&&e.toDateString())}function o(t,e,n){var a=(t=new Date(t)).getDate(),o=t.getMonth()+e;return t.setDate(1),t.setMonth(n?(12+o)%12:o),t.setDate(a),t.getDate()<a&&t.setDate(0),t}function i(t,e){return(t=new Date(t)).setFullYear(t.getFullYear()+e),t}function p(t,e,n){return t<e?e:n<t?n:t}function h(t,e){var n=void 0;return function(){clearTimeout(n),n=setTimeout(e,t)}}function v(){}function r(){for(var t=arguments,e=t[0],n=1;n<t.length;++n){var a=t[n]||{};for(var o in a)e[o]=a[o]}return e}var u={days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:"Today",clear:"Clear",close:"Close"};function s(t){t=t||{},t=r({lang:u,mode:"dp-modal",hilightedDate:l(),format:function(t){return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},parse:function(t){var e=new Date(t);return isNaN(e)?l():e},dateClass:function(){},inRange:function(){return!0}},t);var e,n,a,o=(e=t.parse,function(t){return"string"==typeof t?e(t):t});return t.lang=r(u,t.lang),t.parse=o,t.inRange=(a=(n=t).inRange,function(t,e){return a(t,e)&&n.min<=t&&n.max>=t}),t.min=o(t.min||i(l(),-100)),t.max=o(t.max||i(l(),100)),t.hilightedDate=t.parse(t.hilightedDate),t}var g={left:37,up:38,right:39,down:40,enter:13,esc:27};function m(t,e,n){return e.addEventListener(t,n,!0),function(){e.removeEventListener(t,n,!0)}}var y=function(){var t=window.CustomEvent;"function"!=typeof t&&((t=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}).prototype=window.Event.prototype);return t}();var D={day:{onKeyDown:function(t,e){var n=t.keyCode,a=n===g.left?-1:n===g.right?1:n===g.up?-7:n===g.down?7:0;n===g.esc?e.close():a&&(t.preventDefault(),e.setState({hilightedDate:(o=e.state.hilightedDate,r=a,(o=new Date(o)).setDate(o.getDate()+r),o)}));var o,r},onClick:{"dp-day":function(t,e){e.setState({selectedDate:new Date(parseInt(t.target.getAttribute("data-date")))})},"dp-next":function(t,e){var n=e.state.hilightedDate;e.setState({hilightedDate:o(n,1)})},"dp-prev":function(t,e){var n=e.state.hilightedDate;e.setState({hilightedDate:o(n,-1)})},"dp-today":function(t,e){e.setState({selectedDate:l()})},"dp-clear":function(t,e){e.setState({selectedDate:null})},"dp-close":function(t,e){e.close()},"dp-cal-month":function(t,e){e.setState({view:"month"})},"dp-cal-year":function(t,e){e.setState({view:"year"})}},render:function(r){var i=r.opts,t=i.lang,e=r.state,n=t.days,a=i.dayOffset||0,u=e.selectedDate,s=e.hilightedDate,d=s.getMonth(),c=l().getTime();return'<div class="dp-cal"><header class="dp-cal-header"><button tabindex="-1" type="button" class="dp-prev">Prev</button><button tabindex="-1" type="button" class="dp-cal-month">'+t.months[d]+'</button><button tabindex="-1" type="button" class="dp-cal-year">'+s.getFullYear()+'</button><button tabindex="-1" type="button" class="dp-next">Next</button></header><div class="dp-days">'+n.map(function(t,e){return'<span class="dp-col-header">'+n[(e+a)%n.length]+"</span>"}).join("")+function(t,e,n){var a="",o=new Date(t);o.setDate(1),o.setDate(1-o.getDay()+e),e&&o.getDate()===e+1&&o.setDate(e-6);for(var r=0;r<42;++r)a+=n(o),o.setDate(o.getDate()+1);return a}(s,a,function(t){var e=t.getMonth()!==d,n=!i.inRange(t),a=t.getTime()===c,o="dp-day";return o+=e?" dp-edge-day":"",o+=f(t,s)?" dp-current":"",o+=f(t,u)?" dp-selected":"",o+=n?" dp-day-disabled":"",o+=a?" dp-day-today":"",'<button tabindex="-1" type="button" class="'+(o+=" "+i.dateClass(t,r))+'" data-date="'+t.getTime()+'">'+t.getDate()+"</button>"})+'</div><footer class="dp-cal-footer"><button tabindex="-1" type="button" class="dp-today">'+t.today+'</button><button tabindex="-1" type="button" class="dp-clear">'+t.clear+'</button><button tabindex="-1" type="button" class="dp-close">'+t.close+"</button></footer></div>"}},year:{render:function(t){var e=t.state,n=e.hilightedDate.getFullYear(),a=e.selectedDate.getFullYear();return'<div class="dp-years">'+function(t,e){for(var n="",a=t.opts.max.getFullYear();a>=t.opts.min.getFullYear();--a)n+=e(a);return n}(t,function(t){var e="dp-year";return e+=t===n?" dp-current":"",'<button tabindex="-1" type="button" class="'+(e+=t===a?" dp-selected":"")+'" data-year="'+t+'">'+t+"</button>"})+"</div>"},onKeyDown:function(t,e){var n=t.keyCode,a=e.opts,o=n===g.left||n===g.up?1:n===g.right||n===g.down?-1:0;if(n===g.esc)e.setState({view:"day"});else if(o){t.preventDefault();var r=i(e.state.hilightedDate,o);e.setState({hilightedDate:p(r,a.min,a.max)})}},onClick:{"dp-year":function(t,e){e.setState({hilightedDate:(n=e.state.hilightedDate,a=parseInt(t.target.getAttribute("data-year")),(n=new Date(n)).setFullYear(a),n),view:"day"});var n,a}}},month:{onKeyDown:function(t,e){var n=t.keyCode,a=n===g.left?-1:n===g.right?1:n===g.up?-3:n===g.down?3:0;n===g.esc?e.setState({view:"day"}):a&&(t.preventDefault(),e.setState({hilightedDate:o(e.state.hilightedDate,a,!0)}))},onClick:{"dp-month":function(t,e){e.setState({hilightedDate:(n=e.state.hilightedDate,a=parseInt(t.target.getAttribute("data-month")),o(n,a-n.getMonth())),view:"day"});var n,a}},render:function(t){var e=t.opts.lang.months,a=t.state.hilightedDate.getMonth();return'<div class="dp-months">'+e.map(function(t,e){var n="dp-month";return'<button tabindex="-1" type="button" class="'+(n+=a===e?" dp-current":"")+'" data-month="'+e+'">'+t+"</button>"}).join("")+"</div>"}}};function d(o,r,a){var t,i,e,n,u,s,d=!1,c={el:void 0,opts:a,shouldFocusOnBlur:!0,shouldFocusOnRender:!0,state:{get selectedDate(){return i},set selectedDate(t){t&&!a.inRange(t)||(t?(i=new Date(t),c.state.hilightedDate=i):i=t,c.updateInput(i),r("select"),c.close())},view:"day"},adjustPosition:v,containerHTML:'<div class="dp"></div>',attachToDom:function(){document.body.appendChild(c.el)},updateInput:function(t){var e=new y("change",{bubbles:!0});e.simulated=!0,o.value=t?a.format(t):"",o.dispatchEvent(e)},computeSelectedDate:function(){return a.parse(o.value)},currentView:function(){return D[c.state.view]},open:function(){var t,e,n;d||(c.el||(c.el=(t=a,e=c.containerHTML,(n=document.createElement("div")).className=t.mode,n.innerHTML=e,n),function(a){var t=a.el,e=t.querySelector(".dp");function n(n){n.target.className.split(" ").forEach(function(t){var e=a.currentView().onClick[t];e&&e(n,a)})}t.ontouchstart=v,m("blur",e,h(150,function(){a.hasFocus()||a.close(!0)})),m("keydown",t,function(t){t.keyCode===g.enter?n(t):a.currentView().onKeyDown(t,a)}),m("mousedown",e,function(t){t.target.focus&&t.target.focus(),document.activeElement!==t.target&&(t.preventDefault(),b(a))}),m("click",t,n)}(c)),i=p(c.computeSelectedDate(),a.min,a.max),c.state.hilightedDate=i||a.hilightedDate,c.state.view="day",c.attachToDom(),c.render(),r("open"))},isVisible:function(){return!!c.el&&!!c.el.parentNode},hasFocus:function(){var t=document.activeElement;return c.el&&c.el.contains(t)&&t.className.indexOf("dp-focuser")<0},shouldHide:function(){return c.isVisible()},close:function(t){var e=c.el;if(c.isVisible()){if(e){var n=e.parentNode;n&&n.removeChild(e)}var a;d=!0,t&&c.shouldFocusOnBlur&&((a=o).focus(),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&a.blur()),setTimeout(function(){d=!1},100),r("close")}},destroy:function(){c.close(),t()},render:function(){if(c.el){var t=c.hasFocus(),e=c.currentView().render(c);e&&(c.el.firstChild.innerHTML=e),c.adjustPosition(),(t||c.shouldFocusOnRender)&&b(c)}},setState:function(t){for(var e in t)c.state[e]=t[e];r("statechange"),c.render()}};return e=o,n=c,u=h(5,function(){n.shouldHide()?n.close():n.open()}),s=[m("blur",e,h(150,function(){n.hasFocus()||n.close(!0)})),m("mousedown",e,function(){e===document.activeElement&&u()}),m("focus",e,u),m("input",e,function(t){var e=n.opts.parse(t.target.value);isNaN(e)||n.setState({hilightedDate:e})})],t=function(){s.forEach(function(t){t()})},c}function b(t){var e=t.el.querySelector(".dp-current");return e&&e.focus()}function c(S,t,e){var x=d(S,t,e);return x.shouldFocusOnBlur=!1,Object.defineProperty(x,"shouldFocusOnRender",{get:function(){return S!==document.activeElement}}),x.adjustPosition=function(){var t,e,n,a,o,r,i,u,s,d,c,l,f,p,h,v,g,m,y,D,b,w;c=x,l=S.getBoundingClientRect(),f=window,t=l,e=f,n=c.el,a=e.pageYOffset,o=a+t.top,r=n.offsetHeight,i=o+t.height+8,s=0<(u=o-r-8)&&i+r>a+e.innerHeight,d=s?u:i,n.classList&&(n.classList.toggle("dp-is-above",s),n.classList.toggle("dp-is-below",!s)),n.style.top=d+"px",p=l,h=f,v=c.el,g=h.pageXOffset,m=p.left+g,y=h.innerWidth+g,D=v.offsetWidth,b=y-D,w=y<m+D&&0<b?b:m,v.style.left=w+"px",c.el.style.visibility=""},x}function w(t,e,n){return t=t&&t.tagName?t:document.querySelector(t),"dp-modal"===n.mode?(o=d(a=t,e,n),a.readonly=!0,o.containerHTML+='<a href="#" class="dp-focuser">.</a>',o):"dp-below"===n.mode?c(t,e,n):"dp-permanent"===n.mode?((u=d(r=t,e,i=n)).close=v,u.destroy=v,u.updateInput=v,u.shouldFocusOnRender=!1,u.computeSelectedDate=function(){return i.hilightedDate},u.attachToDom=function(){r.appendChild(u.el)},u.open(),u):void 0;var a,o,r,i,u}function S(){var a={};function n(t,e){(a[t]=a[t]||[]).push(e)}return{on:function(t,e){return e?n(t,e):function(t){for(var e in t)n(e,t[e])}(t),this},emit:function(e,n){(a[e]||[]).forEach(function(t){t(e,n)})},off:function(t,e){return t?a[t]=e?(a[t]||[]).filter(function(t){return t!==e}):[]:a={},this}}}return function(t,e){var n=S(),a=w(t,function(t){n.emit(t,o)},s(e)),o={get state(){return a.state},on:n.on,off:n.off,setState:a.setState,open:a.open,close:a.close,destroy:a.destroy};return o}});

window.onload = ()=>{
  inView(".image").on("enter", showImage)
  loadYoutubeScript()
  TinyDatePicker(".date-picker", {
    format(date) {
      let y = date.getFullYear()
      let m = date.getMonth() + 1
      let d = date.getDate()
      let w = date.getDay()
      m = ('0' + m).slice(-2)
      d = ('0' + d).slice(-2)
      return y + '/' + m + '/' + d
    }
  })
}

function showImage(e) {
  const img = e.querySelector("img")
  if (!img.src) {
    const url = e.getAttribute("data-image")
    if (url) {
      img.src = url
      setTimeout(()=>{
        img.classList.add("visible")
      }, 100)
    }
  }
}

function loadYoutubeScript() {
  const tag = document.createElement("script")
  tag.src = "https://www.youtube.com/iframe_api"
  const firstScriptTag = document.getElementsByTagName("script")[0]
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)
}

window.onYouTubeIframeAPIReady = () => {
  document.querySelectorAll(".youtube").forEach((e)=>{
    setYouTubeVideo(e.id)
  })
}

function setYouTubeVideo(id) {
  const element = document.querySelector("#" + id)
  if (element !== null) {
    new YT.Player(id, {
      width: "100%",
      height: "100%",
      videoId: element.getAttribute('data-key'),
      playerVars: {
        playsinline: 1
      }
    })
  }
}

function getRequest(url, callback) {
  const xhr = new XMLHttpRequest()
  xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
       if (xhr.status == 200) {
         callback(xhr.responseText)
       }
    }
  }
  xhr.open("GET", url, true)
  xhr.send()
}
