<style>
  .admin label span {
    width: 18%;
    display: inline-block;
    text-align: right;
    vertical-align: top;}

  .admin label input,
  .admin label select,
  .admin label textarea {
    width: 80%;
    margin-bottom: 4px;}

  .admin label textarea {
    height: 200px;}

  .admin form {
      text-align: right;
      margin: 16px 0;}

  .admin label input[disabled] {
    background: lightgray;}
</style>

<script>
function update() {
  const code = document.querySelector("#form1").getAttribute("data-code")
  document.form1.action = "<%= link("#{item.class.to_s.downcase}/") %>" + (code ? "update" : "create") + "/" + code
  document.form1.submit()
}

function del() {
  if (window.confirm("delete?")) {
    const code = document.querySelector("#form1").getAttribute("data-code")
    document.form1.action = "<%= link("#{item.class.to_s.downcase}/delete") %>" + code
    document.form1.submit()
	}
}

function onChangeText(key, e) {
  if (key == "name" && !document.querySelector("#form1").getAttribute("data-code")) {
    const code = e.value.toLowerCase().replace(/\s/g, "_")
    document.querySelector("[name=code]").value = code
  }
}

function onClickSite(e) {
  const input = e.parentElement.parentElement.lastElementChild
  if (input.value) {
    console.log(input.value)
    const words = input.value.split(" ")
    const url = encodeURIComponent(words.shift())
    const title = words.join(" ")
    if (!title) {
      input.disabled = true
      ajaxRequest("<%= link("admin/api/site_title") %>", {url: url}, (result, status)=>{
        input.disabled = false
        if (status == 200) {
          input.value += " " + result
        }
      })
    }
  }
}
</script>
